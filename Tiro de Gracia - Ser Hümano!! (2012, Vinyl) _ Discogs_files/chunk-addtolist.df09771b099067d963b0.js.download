webpackJsonp([11],{676:function(t,e,i){var l,a,o,s,d,n,c,r,m;l=i(333),a=i(334),m=i(378),d=i(374),n=i(338),r=i(371),i(677),o=ds.require("alerts"),s=m.getUrl,c={},c.init=function(){return this.$modal=!1,l("body").on("click",".add_to_list",c.listAddHandler).on("click",".remove_from_list",c.remove)},c.listAddHandler=function(t){var e;t.preventDefault(),e=l(this),m.requireLogin()&&m.requireActivation()&&c.add(e.data("list-add-url"),e.data("list-add-pos"))},c.toggleForm=function(){l(".listadd_new").toggle(l("#listpick_new").checked),l("#listadd_old").toggle(l("#listpick_old").checked)},c.add=function(t,e){var i,a;return a=function(){e&&d.legacyTrack("list","opened modal",e)},!!t&&(c.modal||(c.modal=c.makeModal()),c.modal.then(function(t){t.dialog("close")}),i=l.get(s(t),{styleVersion:!0}),Promise.all([c.modal,i]).then(function(t){var e,i;e=t[0],i=t[1],c.insertAndShowModal(e,i),a()}),!0)},c.makeModal=function(){var t;return t=l("<div />").hide().appendTo("body").on("change","#listpick_old, #listpick_new",c.toggleForm).on("click",".lists_list_add_save",c.addSave).on("click",".lists_list_add_cancel",c.addCancel).on("click",".close_add_to_list",c.close),c.$modal=t,c.dialogConfig={width:l("html").hasClass("is_mobile")?l(window).width():440,title:n.getText("Add to List")()},t.discogsDialog(c.dialogConfig).then(function(){return t})},c.insertAndShowModal=function(t,e){var i;i=l("#act"),i.hide(),t.html(e).show().dialog("open")},c.addSave=function(){var t,e,i,r,m,u,_;if(i=l("#list_comments").val(),_=l("#list_title").val(),r=l("#list_description").val(),m=l("#list_oldpick"),t={what:l("#list_what").val(),obid:l("#list_obid").val()},e=function(e){var i,s,d,n;e.success&&e.list_view_href&&e.my_lists_href&&e.close_button?(n=a.template(l("#list_success_message").html())(e),d=a.template(l("#list_new_list_tpl").html())(a.extend(t,e)),s=l("#lists"),i=s.find(".add_to_list"),c.$modal.html(n).show().dialog("open"),s.prepend(d),i.length&&i.appendTo(s.prev("h3"))):e.message&&o.alert(e.message)},i&&(i=l.trim(a.stripTags(i)),t.comments=i),l("#listpick_new").is(":checked")){if(!(_&&_.replace(/\s/g,"").length>0))return void o.alert(n.getText("Please enter a title.")());r&&(r=l.trim(a.stripTags(r)),t.description=r),t.list="new",t.title=_}else{if(u=m.val(),u===-1)return void o.alert(n.getText("Please select an existing list.")());t.title=m.find("option:selected").html(),t.list=u}c.$modal.dialog("close"),l.ajax({type:"POST",url:s("/lists/addsave"),data:t,success:e}).then(function(){d.legacyTrack("list","added",t.what)})},c.addCancel=function(){c.$modal.dialog("close")},c.remove=function(){var t,e,i;return e=function(){return l.ajax({type:"POST",url:s("/lists/update_item"),data:"list="+t.data("list-remove-id")+"&what="+i+"&obid="+t.data("list-remove-obid")+"&remove=1",success:t.remove()})},t=l(this).parent(),i=t.data("list-remove-what"),m.confirm(n.getText("Are you sure you want to remove this item?")()).then(e).then(function(){d.legacyTrack("list","removed",i)})},c.close=function(){var t,e;t=l(this),e=t.data("on-click"),"reload_page"===e?window.location.reload():"hide_list_panel"===e&&c.$modal.dialog("close")},r(function(){return c.init()}),t.exports=c}});
//# sourceMappingURL=chunk-addtolist.df09771b099067d963b0.js.map